# Important linux commands for file processing 

touch  - This command is used to create a new file
ls - This command is used to see the files and folders in the directory. The -l flags shows file permission, sizze etc. and  -a flag shows hidden files.
pwd- (Print working directory) This command is used to viw the current directory path. 
mc - This command is used to move or rename a file
cp - This command is used to copy a file. 
.. - This referes to parent directory of the current directory. 
. - Referes to current directory 
## Example: cp ../file.txt . - This command is used to copy file.txt to from the parent directory to current directory. 
rm- This command is used to delete files. The * will delete all files in the directory. Ex: rm *
rmdir - This command is used to to delete empty directory. 


# Redirection

Redirection: Redirection is a process of sending a stream to a different direction.

We can use Redirection feature of the OS to store the output of a command into a file in stead of just looking at it in a screen. 
## Example: ./hello.py > new_file.txt  Here the output of the hello.py script is saved on the new_file.txt
Remember!! - Each time we perform a redirection of STDOUT the destination is overwritten. 
If we want to append in stead of overwrite, we can use >> in stead of >. Ex: ./hello.py >> new_file.txt

We can also read from a file while executing a command. FOr example, if we write a python script that requires user input,
we can pass a text.file as a input and the script will read the file for input.
## Example: enter_name.py < name.txt The input function only reads until it encounters a newline character. 

We can also redirect the error message into error file using 2>
error_gen.py 2> error_file.txt

These redirection process works for all types of programs in linux. 


# Pipes and pipelines 

Pipes: Pipes connect the output of one program to the input of another in order to pass data between programs. 
## Example: ls -l | less
The list of files generated by ls is piped to less, which displays them one page at a time. We can scroll up or down using the page up, page down, or arrow keys.
Another complex example: cat spider.txt | tr ' ' '\n' | sort | uniq -c | sort -nr | head 
Here, the tr (short for translate) command converts the space characterof the spider.txt to new line character and then the sort command arrnages the output alphabetically, 
after that the uniq command takes each unique characters once and the -c flag asssociate the number of times those charcaters repeated with those charcaters.
Finally, the sort command sort the output into to numerical reverse order and head command shows the first 10 lines of the output. 

The pipes can also be implemented with python scripts. 
## Example: cat haiku.txt | ./capitilize.py  This will capitlize the first character of each line of the heiku.txt file. 
capitilize.py:
import sys
for line in sys.stdin:
    print(line.strip.capitilize())

We can also do this using the redirection operator mentioned before. 
Example: ./capitilize.py < haiku.txt


# Signalling processes

Signals: Tokens delivered to running processes to indicate a desired action. 

## Example: ctrl + c signals sends signal to running process to finish the process cleanly. 
## Example: ctrl + z signals sends signal to running process to stop the process. We can restart the process by executing fg command. 

We can use kill command along with process ID or PID to terminate a specific process. 
The ps command will list currently running processes on linux. The ps ax will list all the running processes in the computer. 
## Example: 
ps ax | grep ping  This command shows the ping process and corresponding PID that is currently running. 
kill <ping PID>  This command will terminate the ping process. 


# Bash scripting

## Example bash script:
#!/bin/bash 

echo "starting at: $(date)"
echo 

echo "UPTIME"
uptime 
echo 

echo "FREE"
free 
echo 

echo "WHO"
who 
echo 

echo "Finishing at: $(date)"

This script will output how long the computer is on, how much memory is free, and who are currently logged into the computer, along with starting and ending time. 
The extension of bash script is .sh 
We can also sepate each command with a semicolon in stead of new line. Ex: echo "UPTIME"; uptime; echo 
uptime 


# Using variables and globs:

Variables:
example=hello  There can be no space between the variable and equal sign and the value
echo $example 
## Example:
#!/bin/bash 
line="-----------------------------------"
echo "starting at: $(date)"; echo $line

echo "UPTIME"; uptime; echo $line

echo "FREE"; free; echo $line

echo "WHO"; who; echo $line 

echo "Finishing at: $(date)"

globs: globs are characters that allows us to create list of files e.g '?', '*', etc.
The * glob will match any number character in the place of the *
Example: echo *.py     This will show all the files with .py extension
         echo c*       This will show all the files that start with c
         echo *        This will match all the files in the current directory
The ? will match exactly one character in place of ? and we can use this as many times we want. 
## Example: echo ?????.py This will match up to five character long python files in the directory  
We can use glob in python using glob module. 


# Conditional Execution in bash

In bash scriptng the exit value 0 means success. The exit status can be checked using $? command
## Example bash script:
#!/bin/bash

if grep "127.0.0.1" /etc/hosts; then
    echo "Everything ok"
else
    echo "Error! 127.0.0.1 is not in /etc/hosts"
fi   

if condition is finished with keyword fi

Test: Test is a command that evaluates the conditions received and exits with zero when they're true and with one when they are false. 
Example: if test -n "$PATH"; then echo "your path is not empty"; fi 
Here -n option of the test command checks if the string is empty or not. 
Another way of wiritng same command: if [] -n "$PATH" ]; then echo "your path is not empty"; fi
Here [] is an alias of test command. Remember there needs to be a space before the closing bracket. 


# Advanced bash concepts

## While loop in bash:
#!/bin/bash 

n=1
while [ $n -le 5 ]; do
    echo "Iterating number $n"
    ((n+=1))
done 

- le operator checks if n is less than or equal to 5. While loop is finished with keyword done
Double parenthesis in bash allows performing arithmatic operations

## Example: This bash script will check exit status of the passed command line argument up to five times until the exit status is 0 (ok). 
#!/bin/bash 

n=0
command=$1   This command is equivalent to python sys.argv[1]
while != $command && [ $n -le 5 ]; do
    sleep $n
    ((n+=1))
    echo "Retry in #$n"
done
Execution: ./retry.sh ./random-exit.py

## For loops in bash

## Example:
#!/bin/bash

for fruit in peach apple orange; do
    echo "I like $fruit"
done

In bash, the for loops iterates over the elements spaced by a space. Since the * and ? globs output files with a space, for loops could be used to 
perform differnt file operations. 

## Example: Renaming files in a directory using for loop
#!/bin/bash

for file in *.HTM; do
    name=$(basename "file" .HTM)
    mv "$file" "$name.html"
done 

It is good idea to check the script if before actually running to modify the file system. To check we can add echo before the mv. 

## Advanced command interaction 

## Example bash script that shows a list of processes that have been performed most from syslog
#!/bin/bash

for logfile in /var/log/*log; do
    echo "Processing $logfile"
    cut -d' ' -f5- $logfile | sort | uniq -c | sort -nr | head -5 
done 

The cut command splits the loglines based on space character and takes the fifth element. 
The cut command lets us take only bits of each line using a field delimiter. 